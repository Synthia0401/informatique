<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cin√©Max - R√©servez vos places</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="brand">
                <span class="logo-icon">üé¨</span>
                <span class="brand-text">Cin√©Max</span>
            </div>
            <div class="nav-search">
                <input type="text" id="search" placeholder="RECHERCHER" class="search-input" autocomplete="off">
                <svg class="search-icon" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <div id="search-suggestions" class="search-suggestions hidden"></div>
            </div>
            <div class="nav-account">
                <button id="account-btn" class="account-button" title="Mon compte">üë§</button>
                <div id="account-menu" class="account-menu hidden">
                    <div id="account-logged-in" class="hidden">
                        <div class="account-user-info">
                            <p id="account-user-name"></p>
                            <p id="account-user-email"></p>
                        </div>
                        <button id="admin-btn" class="account-menu-item hidden" title="Panneau d'administration">‚öôÔ∏è Administration</button>
                        <button id="logout-btn" class="account-menu-item logout">D√©connexion</button>
                    </div>
                    <div id="account-logged-out">
                        <button id="login-btn-menu" class="account-menu-item">Connexion</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Bienvenue au Cin√©Max</h1>
            <p class="hero-subtitle">D√©couvrez nos films, consultez les s√©ances et r√©servez vos places</p>
            <div class="hero-buttons">
                <a href="#movies" class="cta-button">Parcourir les films</a>
                <a href="#prices" class="cta-button cta-secondary">Nos Tarifs</a>
                <button id="my-bookings-btn-hero" class="cta-button my-bookings-hero hidden">Mes r√©servations</button>
                <button id="add-film-btn-hero" class="cta-button cta-secondary hidden">Ajouter un film</button>
                <button id="add-showtime-btn-hero" class="cta-button cta-secondary hidden">Ajouter une s√©ance</button>
            </div>
        </div>
        <div class="hero-background"></div>
    </header>

    <main>
        <!-- Movies Section -->
        <section id="movies" class="movies-section">
            <div class="container">
                <h2 class="section-title">√Ä l'affiche</h2>
                <div class="movies-grid">
                    {% for m in movies %}
                    <div class="movie-card" data-title="{{ m.title }}" data-color="{{ m.color }}">
                        <div class="movie-poster">
                            <img src="{{ m.poster }}" alt="Affiche {{ m.title }}" loading="lazy">
                            <div class="movie-overlay">
                                <span class="rating">{{ m.ratings }}</span>
                            </div>
                        </div>
                        <div class="movie-info">
                            <h3 class="movie-title">{{ m.title }}</h3>
                            <p class="movie-director"><strong>R√©alisateur:</strong> {{ m.director }}</p>
                            <p class="movie-cast"><strong>Acteurs:</strong> {{ m.cast }}</p>
                            <p class="movie-meta">‚è±Ô∏è {{ m.duration }} min | {{ m.ratings }}</p>
                            <p class="movie-description">{{ m.description }}</p>
                            <div class="movie-links">
                                {% if m.trailer %}
                                    <a href="{{ m.trailer }}" target="_blank" class="trailer-btn">üé¨ Bande-annonce</a>
                                {% endif %}
                            </div>
                            <div class="showtimes">
                                <button class="reserve-btn" data-movie-id="{{ m.id }}" data-title="{{ m.title }}" data-showtimes="{{ m.showtimes|join(',') }}">üìÖ R√©server</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>

        <!-- Prices Section -->
        <section id="prices" class="prices-section">
            <div class="container">
                <h2 class="section-title">Nos Tarifs</h2>
                <div class="prices-table-wrapper">
                    <table class="prices-table">
                        <tbody>
                            <tr>
                                <td class="price-category">Adulte</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.adult }} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td class="price-category">Enfants</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.child }} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td class="price-category">Seniors</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.senior }} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td class="price-category">√âtudiants</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.student }} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td class="price-category">Personnes handicap√©es</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.disabled }} ‚Ç¨</td>
                            </tr>
                            <tr>
                                <td class="price-category">Demandeurs d'emploi</td>
                                <td class="price-availability">Tous les jours</td>
                                <td class="price-amount">{{ prices.unemployed }} ‚Ç¨</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; {{ current_year }} Cin√©Max - Tous droits r√©serv√©s</p>
                <p class="footer-subtitle">Plateforme de r√©servation de cin√©ma</p>
            </div>
        </div>
    </footer>

    <!-- Booking Modal -->
    <div id="booking-modal" class="modal hidden" role="dialog" aria-hidden="true" aria-labelledby="modal-title">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Fermer la modale">‚úï</button>
            <h2 id="modal-title" class="modal-title">R√©server vos places</h2>
            <form id="booking-form" class="booking-form">
                <div class="form-group">
                    <label for="bk-film">Film</label>
                    <input type="text" id="bk-film" readonly>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="bk-date">Date</label>
                        <input type="date" id="bk-date">
                    </div>
                    <div class="form-group">
                        <label for="bk-time">S√©ance</label>
                        <select id="bk-time">
                            <option value="">S√©lectionnez une s√©ance</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="bk-count">Nombre de places</label>
                    <select id="bk-count">
                        <option value="">S√©lectionnez un nombre</option>
                        <option value="1">1 place</option>
                        <option value="2">2 places</option>
                        <option value="3">3 places</option>
                        <option value="4">4 places</option>
                        <option value="5">5 places</option>
                        <option value="6">6 places</option>
                    </select>
                </div>
                <!-- Hidden fields for showtime and theatre -->
                <input type="hidden" id="bk-showtime-id">
                <input type="hidden" id="bk-theatre-id">
                <input type="hidden" id="bk-selected-seats" value="[]">
                <!-- Button to select seats -->
                <div id="seat-selection-button" class="seat-selection-button hidden">
                    <button type="button" class="btn btn-accent" id="choose-seats-btn">Choisir mes places</button>
                </div>
                <!-- Seat categories section -->
                <div id="seat-categories" class="seat-categories hidden">
                    <h3>Cat√©gories tarifaires</h3>
                    <div id="seat-category-list"></div>
                    <div class="price-summary">
                        <p>Prix total: <span id="total-price">0.00</span> ‚Ç¨</p>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Confirmer la r√©servation</button>
                    <button type="button" class="btn btn-secondary" id="modal-cancel">Annuler</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Seat Selection Modal -->
    <div id="seat-selection-modal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-backdrop"></div>
        <div class="modal-content seat-selection-modal-content">
            <button class="modal-close" aria-label="Fermer la modale">‚úï</button>
            <h2 class="modal-title">S√©lectionnez vos places</h2>
            <div id="seat-layout" class="seat-layout"></div>
            <div class="seat-selection-info">
                <p>Places s√©lectionn√©es: <span id="selected-count">0</span>/<span id="required-count">0</span></p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-primary" id="confirm-seats-btn">Confirmer les places</button>
                <button type="button" class="btn btn-secondary" id="cancel-seats-btn">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-backdrop"></div>
        <div class="modal-content auth-modal">
            <button class="modal-close" aria-label="Fermer la modale">‚úï</button>

            <!-- Login Form -->
            <div id="login-form-section" class="auth-section">
                <h2 class="modal-title">Connexion</h2>
                <form id="login-form" class="booking-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Mot de passe</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Se connecter</button>
                    <div id="login-error" class="error-message hidden"></div>
                </form>
                <div class="auth-switch-link">
                    Pas de compte? <button id="switch-to-register" class="link-btn">Cr√©er un</button>
                </div>
            </div>

            <!-- Register Form -->
            <div id="register-form-section" class="auth-section hidden">
                <h2 class="modal-title">Cr√©er un compte</h2>
                <form id="register-form" class="booking-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="register-prenom">Pr√©nom</label>
                            <input type="text" id="register-prenom" required>
                        </div>
                        <div class="form-group">
                            <label for="register-nom">Nom</label>
                            <input type="text" id="register-nom" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Mot de passe</label>
                        <input type="password" id="register-password" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="register-sexe">Sexe</label>
                            <select id="register-sexe" required>
                                <option value="">--S√©lectionner--</option>
                                <option value="M">Homme</option>
                                <option value="F">Femme</option>
                                <option value="O">Autre</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="register-ville">Ville</label>
                            <input type="text" id="register-ville" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="register-habitation">Adresse</label>
                        <input type="text" id="register-habitation" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Cr√©er mon compte</button>
                    <div id="register-error" class="error-message hidden"></div>
                </form>
                <div class="auth-switch-link">
                    D√©j√† connect√©? <button id="switch-to-login" class="link-btn">Se connecter</button>
                </div>
            </div>
        </div>
    </div>

    <!-- My Bookings Modal -->
    <div id="bookings-modal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Fermer la modale">‚úï</button>
            <h2 class="modal-title">Mes r√©servations</h2>
            <div id="bookings-list" class="bookings-list">
                <p>Aucune r√©servation pour le moment.</p>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="admin-modal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <button class="modal-close" aria-label="Fermer la modale">‚úï</button>
            <h2 class="modal-title">Panneau Admin</h2>

            <div class="admin-tabs">
                <button class="admin-tab-btn active" data-tab="add-showtime">Ajouter une s√©ance</button>
            </div>

            <!-- Add Showtime Form -->
            <div id="add-showtime-tab" class="admin-tab-content active">
                <form id="add-showtime-form" class="booking-form">
                    <div class="form-group">
                        <label for="admin-film">Film</label>
                        <input type="text" id="admin-film" placeholder="Titre du film" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="admin-date">Date</label>
                            <input type="date" id="admin-date" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-time">Heure</label>
                            <input type="time" id="admin-time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="admin-theatre">Salle</label>
                        <select id="admin-theatre" required>
                            <option value="">S√©lectionnez une salle</option>
                            <option value="1">Salle 1</option>
                            <option value="2">Salle 2</option>
                            <option value="3">Salle 3</option>
                            <option value="4">Salle 4</option>
                            <option value="5">Salle 5</option>
                            <option value="6">Salle 6</option>
                            <option value="7">Salle 7</option>
                            <option value="8">Salle 8</option>
                            <option value="9">Salle 9</option>
                            <option value="10">Salle 10</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Ajouter la s√©ance</button>
                    <div id="admin-showtime-error" class="error-message hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>